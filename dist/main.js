(()=>{"use strict";const e={createDocument:function(e){return(new DOMParser).parseFromString(e.trim(),"text/xml")}};var t=Uint8Array,r=Uint16Array,n=Uint32Array,o=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),u=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(e,t){for(var o=new r(31),i=0;i<31;++i)o[i]=t+=1<<e[i-1];var u=new n(o[30]);for(i=1;i<30;++i)for(var a=o[i];a<o[i+1];++a)u[a]=a-o[i]<<5|i;return[o,u]},l=a(o,2),c=l[0],f=l[1];c[28]=258,f[258]=28;for(var s=a(i,0),p=s[0],y=(s[1],new r(32768)),w=0;w<32768;++w){var m=(43690&w)>>>1|(21845&w)<<1;m=(61680&(m=(52428&m)>>>2|(13107&m)<<2))>>>4|(3855&m)<<4,y[w]=((65280&m)>>>8|(255&m)<<8)>>>1}var v=function(e,t,n){for(var o=e.length,i=0,u=new r(t);i<o;++i)e[i]&&++u[e[i]-1];var a,l=new r(t);for(i=0;i<t;++i)l[i]=l[i-1]+u[i-1]<<1;if(n){a=new r(1<<t);var c=15-t;for(i=0;i<o;++i)if(e[i])for(var f=i<<4|e[i],s=t-e[i],p=l[e[i]-1]++<<s,w=p|(1<<s)-1;p<=w;++p)a[y[p]>>>c]=f}else for(a=new r(o),i=0;i<o;++i)e[i]&&(a[i]=y[l[e[i]-1]++]>>>15-e[i]);return a},b=new t(288);for(w=0;w<144;++w)b[w]=8;for(w=144;w<256;++w)b[w]=9;for(w=256;w<280;++w)b[w]=7;for(w=280;w<288;++w)b[w]=8;var h=new t(32);for(w=0;w<32;++w)h[w]=5;var d=v(b,9,1),g=v(h,5,1),S=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},O=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},j=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},E=function(e,o,i){(null==o||o<0)&&(o=0),(null==i||i>e.length)&&(i=e.length);var u=new(2==e.BYTES_PER_ELEMENT?r:4==e.BYTES_PER_ELEMENT?n:t)(i-o);return u.set(e.subarray(o,i)),u},A=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(e,t,r){var n=new Error(t||A[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,P),!r)throw n;return n},C=new t(0),V=function(e,t){return e[t]|e[t+1]<<8},T=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},x=function(e,t){return T(e,t)+4294967296*T(e,t+4)};function k(e,r){return function(e,r,n){var a=e.length;if(!a||n&&n.f&&!n.l)return r||new t(0);var l=!r||n,f=!n||n.i;n||(n={}),r||(r=new t(3*a));var s,y=function(e){var n=r.length;if(e>n){var o=new t(Math.max(2*n,e));o.set(r),r=o}},w=n.f||0,m=n.p||0,b=n.b||0,h=n.l,A=n.d,C=n.m,V=n.n,T=8*a;do{if(!h){w=O(e,m,1);var x=O(e,m+1,3);if(m+=3,!x){var k=e[(s=m,($=4+((s+7)/8|0))-4)]|e[$-3]<<8,I=$+k;if(I>a){f&&P(0);break}l&&y(b+k),r.set(e.subarray($,I),b),n.b=b+=k,n.p=m=8*I,n.f=w;continue}if(1==x)h=d,A=g,C=9,V=5;else if(2==x){var N=O(e,m,31)+257,D=O(e,m+10,15)+4,R=N+O(e,m+5,31)+1;m+=14;for(var _=new t(R),F=new t(19),M=0;M<D;++M)F[u[M]]=O(e,m+3*M,7);m+=3*D;var q=S(F),L=(1<<q)-1,U=v(F,q,1);for(M=0;M<R;){var $,B=U[O(e,m,L)];if(m+=15&B,($=B>>>4)<16)_[M++]=$;else{var z=0,X=0;for(16==$?(X=3+O(e,m,3),m+=2,z=_[M-1]):17==$?(X=3+O(e,m,7),m+=3):18==$&&(X=11+O(e,m,127),m+=7);X--;)_[M++]=z}}var G=_.subarray(0,N),Y=_.subarray(N);C=S(G),V=S(Y),h=v(G,C,1),A=v(Y,V,1)}else P(1);if(m>T){f&&P(0);break}}l&&y(b+131072);for(var W=(1<<C)-1,H=(1<<V)-1,J=m;;J=m){var K=(z=h[j(e,m)&W])>>>4;if((m+=15&z)>T){f&&P(0);break}if(z||P(2),K<256)r[b++]=K;else{if(256==K){J=m,h=null;break}var Q=K-254;if(K>264){var Z=o[M=K-257];Q=O(e,m,(1<<Z)-1)+c[M],m+=Z}var ee=A[j(e,m)&H],te=ee>>>4;if(ee||P(3),m+=15&ee,Y=p[te],te>3&&(Z=i[te],Y+=j(e,m)&(1<<Z)-1,m+=Z),m>T){f&&P(0);break}l&&y(b+131072);for(var re=b+Q;b<re;b+=4)r[b]=r[b-Y],r[b+1]=r[b+1-Y],r[b+2]=r[b+2-Y],r[b+3]=r[b+3-Y];b=re}}n.l=h,n.p=J,n.b=b,n.f=w,h&&(w=1,n.m=C,n.d=A,n.n=V)}while(!w);return b==r.length?r:E(r,0,b)}(e,r)}var I="undefined"!=typeof TextDecoder&&new TextDecoder;try{I.decode(C,{stream:!0})}catch(e){}function N(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}if(I)return I.decode(e);var o=function(e){for(var t="",r=0;;){var n=e[r++],o=(n>127)+(n>223)+(n>239);if(r+o>e.length)return[t,E(e,r-1)];o?3==o?(n=((15&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|n>>10,56320|1023&n)):t+=1&o?String.fromCharCode((31&n)<<6|63&e[r++]):String.fromCharCode((15&n)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(n)}}(e),i=o[0];return o[1].length&&P(8),i}var D=function(e,t){return t+30+V(e,t+26)+V(e,t+28)},R=function(e,t,r){var n=V(e,t+28),o=N(e.subarray(t+46,t+46+n),!(2048&V(e,t+8))),i=t+46+n,u=T(e,t+20),a=r&&4294967295==u?_(e,i):[u,T(e,t+24),T(e,t+42)],l=a[0],c=a[1],f=a[2];return[V(e,t+10),l,c,o,i+V(e,t+30)+V(e,t+32),f]},_=function(e,t){for(;1!=V(e,t);t+=4+V(e,t+2));return[x(e,t+12),x(e,t+4),x(e,t+20)]};function F(e){var r=function(e,r){for(var n={},o=e.length-22;101010256!=T(e,o);--o)(!o||e.length-o>65558)&&P(13);var i=V(e,o+8);if(!i)return{};var u=T(e,o+16),a=4294967295==u||65535==i;if(a){var l=T(e,o-12);(a=101075792==T(e,l))&&(i=T(e,l+32),u=T(e,l+48))}for(var c=r,f=0;f<i;++f){var s=R(e,u,a),p=s[0],y=s[1],w=s[2],m=s[3],v=s[4],b=s[5],h=D(e,b);u=v,c&&!c({name:m,size:y,originalSize:w,compression:p})||(p?8==p?n[m]=k(e.subarray(h,h+y),new t(w)):P(14,"unknown compression type "+p):n[m]=E(e,h,h+y))}return n}(new Uint8Array(e));return Promise.resolve(function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];t[o]=N(e[o])}return t}(r))}function M(e,t){for(var r=0;r<e.childNodes.length;){var n=e.childNodes[r];if(1===n.nodeType&&$(n)===t)return n;r++}}function q(e,t){for(var r=[],n=0;n<e.childNodes.length;){var o=e.childNodes[n];1===o.nodeType&&$(o)===t&&r.push(o),n++}return r}function L(e,t,r){for(var n=0;n<e.childNodes.length;){var o=e.childNodes[n];t?1===o.nodeType&&$(o)===t&&r(o,n):r(o,n),n++}}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var U=/.+\:/;function $(e){return e.tagName.replace(U,"")}function B(e){if(1!==e.nodeType)return e.textContent;for(var t="<"+$(e),r=0;r<e.attributes.length;)t+=" "+e.attributes[r].name+'="'+e.attributes[r].value+'"',r++;t+=">";for(var n=0;n<e.childNodes.length;)t+=B(e.childNodes[n]),n++;return t+"</"+$(e)+">"}function z(e){return"/"===e[0]?e.slice(1):"xl/"+e}function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e){if("object"!==X(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===X(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e){return{id:e.getAttribute("numFmtId"),template:e.getAttribute("formatCode")}}function H(e,t){var r={};if(e.hasAttribute("numFmtId")){var n=e.getAttribute("numFmtId");t[n]?r.numberFormat=t[n]:r.numberFormat={id:n}}return r}function J(e,t){return t&&t.epoch1904&&(e+=1462),new Date(Math.round(24*(e-25569)*36e5))}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q(e,t,r){if(e){var n=t[e];if(!n)throw new Error("Cell style not found: ".concat(e));if(!n.numberFormat)return!1;if(Z.indexOf(Number(n.numberFormat.id))>=0||r.dateFormat&&n.numberFormat.template===r.dateFormat||!1!==r.smartDateParser&&n.numberFormat.template&&function(e){for(var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return K(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?K(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}((e=(e=(e=e.toLowerCase()).replace(ee,"")).replace(te,"")).split(/\W+/));!(t=r()).done;){var n=t.value;if(re.indexOf(n)<0)return!1}return!0}(n.numberFormat.template))return!0}}var Z=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],ee=/^\[\$-414\]/,te=/;@$/,re=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function ne(e,t,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,i=r.getStyleId,u=r.styles,a=r.values,l=r.properties,c=r.options;switch(t||(t="n"),t){case"str":e=oe(e,c);break;case"inlineStr":if(void 0===(e=n()))throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));e=oe(e,c);break;case"s":var f=Number(e);if(isNaN(f))throw new Error('Invalid "shared" string index: '.concat(e));if(f>=a.length)throw new Error('An out-of-bounds "shared" string index: '.concat(e));e=oe(e=a[f],c);break;case"b":if("1"===e)e=!0;else{if("0"!==e)throw new Error('Unsupported "boolean" cell value: '.concat(e));e=!1}break;case"z":e=void 0;break;case"e":e=function(e){switch(e){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(e)}}(e);break;case"d":if(void 0===e)break;var s=new Date(e);if(isNaN(s.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(e));e=s;break;case"n":if(void 0===e)break;e=Q(i(),u,c)?J(e=ie(e),l):(c.parseNumber||ie)(e);break;default:throw new TypeError("Cell type not supported: ".concat(t))}return void 0===e&&(e=null),e}function oe(e,t){return!1!==t.trim&&(e=e.trim()),""===e&&(e=void 0),e}function ie(e){var t=Number(e);if(isNaN(t))throw new Error('Invalid "numeric" cell value: '.concat(e));return t}var ue=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function ae(e){for(var t=0,r=0;r<e.length;)t*=26,t+=ue.indexOf(e[r]),r++;return t}function le(e){return e=e.split(/(\d+)/),[parseInt(e[1]),ae(e[0].trim())]}function ce(e,t,r,n,o,i,u){var a,l=le(e.getAttribute("r")),c=function(e,t){return M(t,"v")}(0,e),f=c&&c.textContent;return e.hasAttribute("t")&&(a=e.getAttribute("t")),{row:l[0],column:l[1],value:ne(f,a,{getInlineStringValue:function(){return function(e,t){if(t.firstChild&&"is"===$(t.firstChild)&&t.firstChild.firstChild&&"t"===$(t.firstChild.firstChild))return t.firstChild.firstChild.textContent}(0,e)},getInlineStringXml:function(){return B(e)},getStyleId:function(){return e.getAttribute("s")},styles:o,values:n,properties:i,options:u})}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function se(e){var t=function(e){var t=M(e.documentElement,"dimension");if(t)return t.getAttribute("ref")}(e);if(t)return 1===(t=t.split(":").map(le).map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,u,a=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return fe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2);return{row:t[0],column:t[1]}}))).length&&(t=[t[0],t[0]]),t}function pe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ye(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function we(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?me(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ve(e,t){if(e){if("string"==typeof e)return be(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function he(e,t){var r=e.dimensions,n=e.cells;if(0===n.length)return[];for(var o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,u,a=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(e,t)||ve(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r,2),i=(o[0],o[1]),u=i.column,a=i.row,l=new Array(a),c=0;c<a;){l[c]=new Array(u);for(var f=0;f<u;)l[c][f]=null,f++;c++}for(var s,p=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=ve(e))){t&&(e=t);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n);!(s=p()).done;){var y=s.value,w=y.row-1,m=y.column-1;m<u&&w<a&&(l[w][m]=y.value)}var v=t.rowMap;if(v)for(var b=0;b<l.length;)v[b]=b,b++;return l=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.rowIndexMap,n=t.accessor,o=void 0===n?function(e){return e}:n,i=t.onlyTrimAtTheEnd,u=e.length-1;u>=0;){for(var a,l=!0,c=pe(e[u]);!(a=c()).done;)if(null!==o(a.value)){l=!1;break}if(l)e.splice(u,1),r&&r.splice(u,1);else if(i)break;u--}return e}(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.accessor,n=void 0===r?function(e){return e}:r,o=t.onlyTrimAtTheEnd,i=e[0].length-1;i>=0;){for(var u,a=!0,l=we(e);!(u=l()).done;)if(null!==n(u.value[i])){a=!1;break}if(a)for(var c=0;c<e.length;)e[c].splice(i,1),c++;else if(o)break;i--}return e}(l,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowIndexMap:v}),t.transformData&&(l=t.transformData(l)),l}function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e){if("object"!==de(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===de(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function je(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.sheet||(r=Oe({sheet:1},r));var n=function(t){if(!e[t])throw new Error('"'.concat(t,'" file not found inside the *.xlsx file zip archive'));return e[t]},o=function(e,t){var r=t.createDocument(e),n={sheets:{},sharedStrings:void 0,styles:void 0};return function(e){return q(e.documentElement,"Relationship")}(r).forEach((function(e){var t=e.getAttribute("Target");switch(e.getAttribute("Type")){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=z(t);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=z(t);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[e.getAttribute("Id")]=z(t)}})),n}(n("xl/_rels/workbook.xml.rels"),t),i=o.sharedStrings?function(e,t){return e?function(e){var t,r,n=e.documentElement;return t=function(e){var t=M(e,"t");if(t)return t.textContent;var r="";return L(e,"r",(function(e){r+=M(e,"t").textContent})),r},r=[],L(n,"si",(function(e,n){r.push(t(e))})),r}(t.createDocument(e)):[]}(n(o.sharedStrings),t):[],u=o.styles?function(e,t){if(!e)return{};var r=t.createDocument(e),n=function(e){var t=M(e.documentElement,"cellStyleXfs");return t?q(t,"xf"):[]}(r).map(H),o=function(e){var t=M(e.documentElement,"numFmts");return t?q(t,"numFmt"):[]}(r).map(W).reduce((function(e,t){return e[t.id]=t,e}),[]);return function(e){var t=M(e.documentElement,"cellXfs");return t?q(t,"xf"):[]}(r).map((function(e){return e.hasAttribute("xfId")?Y(Y({},n[e.xfId]),H(e,o)):H(e,o)}))}(n(o.styles),t):{},a=function(e,t){var r=t.createDocument(e),n={},o=function(e){return M(e.documentElement,"workbookPr")}(r);return o&&"1"===o.getAttribute("date1904")&&(n.epoch1904=!0),n.sheets=[],function(e){return q(M(e.documentElement,"sheets"),"sheet")}(r).forEach((function(e){e.getAttribute("name")&&n.sheets.push({id:e.getAttribute("sheetId"),name:e.getAttribute("name"),relationId:e.getAttribute("r:id")})})),n}(n("xl/workbook.xml"),t);if(r.getSheets)return a.sheets.map((function(e){return{name:e.name}}));var l=function(e,t){if("number"==typeof e){var r=t[e-1];return r&&r.relationId}for(var n,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ge(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(n=o()).done;){var i=n.value;if(i.name===e)return i.relationId}}(r.sheet,a.sheets);if(!l||!o.sheets[l])throw function(e,t){var r=t&&t.map((function(e,t){return'"'.concat(e.name,'" (#').concat(t+1,")")})).join(", ");return new Error("Sheet ".concat("number"==typeof e?"#"+e:'"'+e+'"'," not found in the *.xlsx file.").concat(t?" Available sheets: "+r+".":""))}(r.sheet,a.sheets);var c=function(e,t,r,n,o,i){var u=t.createDocument(e),a=function(e,t,r,n,o,i){var u=function(e){var t=M(e.documentElement,"sheetData"),r=[];return L(t,"row",(function(e){L(e,"c",(function(e){r.push(e)}))})),r}(e);return 0===u.length?[]:u.map((function(e){return ce(e,0,0,r,n,o,i)}))}(u,0,r,n,o,i),l=se(u)||function(e){var t=function(e,t){return e-t},r=e.map((function(e){return e.row})).sort(t),n=e.map((function(e){return e.column})).sort(t),o=r[0],i=r[r.length-1];return[{row:o,column:n[0]},{row:i,column:n[n.length-1]}]}(a);return{cells:a,dimensions:l}}(n(o.sheets[l]),t,i,u,a,r),f=he(c,r=Oe({rowMap:[]},r));return r.properties?{data:f,properties:a}:f}function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function Ae(e){var t="function"==typeof Map?new Map:void 0;return Ae=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Pe(e,arguments,Te(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ve(n,e)},Ae(e)}function Pe(e,t,r){return Pe=Ce()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&Ve(o,r.prototype),o},Pe.apply(null,arguments)}function Ce(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ve(e,t){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ve(e,t)}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Te(e)}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ve(e,t)}(i,e);var t,r,n,o=(r=i,n=Ce(),function(){var e,t=Te(r);if(n){var o=Te(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,"invalid")).reason=e,t}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(Ae(Error));function ke(e){if("string"==typeof e){var t=e;if(e=Number(e),String(e)!==t)throw new xe("not_a_number")}if("number"!=typeof e)throw new xe("not_a_number");if(isNaN(e))throw new xe("invalid_number");if(!isFinite(e))throw new xe("out_of_bounds");return e}function Ie(e){if("string"==typeof e)return e;if("number"==typeof e){if(isNaN(e))throw new xe("invalid_number");if(!isFinite(e))throw new xe("out_of_bounds");return String(e)}throw new xe("not_a_string")}function Ne(e){if("boolean"==typeof e)return e;throw new xe("not_a_boolean")}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,u,a=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(e,t)||_e(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function _e(e,t){if(e){if("string"==typeof e)return Fe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fe(e,t):void 0}}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e){if("object"!==Re(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Re(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Le={schemaPropertyValueForMissingColumn:void 0,schemaPropertyValueForUndefinedCellValue:void 0,schemaPropertyValueForNullCellValue:null,schemaPropertyShouldSkipRequiredValidationForMissingColumn:function(){return!1},getEmptyObjectValue:function(){return null},getEmptyArrayValue:function(){return null},isColumnOriented:!1,arrayValueSeparator:","};function Ue(e,t,r,n,o,i,u){for(var a={},l=!0,c=function(t){var n=t.column,o=t.value,i=t.error,u=t.reason,a={error:i,row:r+1,column:n,value:o};return u&&(a.reason=u),e[n].type&&(a.type=e[n].type),a},f=[],s=function(){var s,w,m,v,b=y[p],h=e[b],d="object"===Re(h.type)&&!Array.isArray(h.type),g="".concat(n||"",".").concat(h.prop),S=o.indexOf(b),O=S<0;if(O||(s=t[S]),d)w=Ue(h.type,t,r,g,o,i,u);else if(O)w=u.schemaPropertyValueForMissingColumn;else if(void 0===s)w=u.schemaPropertyValueForUndefinedCellValue;else if(null===s)w=u.schemaPropertyValueForNullCellValue;else if(Array.isArray(h.type)){var j=function(e,t){for(var r=[],n=0;n<e.length;){var o=De(ze(e,t,n),2),i=o[0];n+=o[1]+t.length,r.push(i.trim())}return r}(s,u.arrayValueSeparator).map((function(e){if(!m){var t=$e(e,h,u);return t.error&&(w=e,m=t.error,v=t.reason),t.value}}));if(!m){var E=j.every(Ge);w=E?u.getEmptyArrayValue(j,{path:g}):j}}else{var A=$e(s,h,u);m=A.error,v=A.reason,w=m?s:A.value}!m&&Ge(w)&&h.required&&f.push({column:b,value:w,isMissingColumn:O}),m?i.push(c({column:b,value:w,error:m,reason:v})):(l&&!Ge(w)&&(l=!1),void 0!==w&&(a[h.prop]=w))},p=0,y=Object.keys(e);p<y.length;p++)s();if(l)return u.getEmptyObjectValue(a,{path:n});for(var w=0,m=f;w<m.length;w++){var v=m[w],b=v.column,h=v.value;if(!v.isMissingColumn||!u.schemaPropertyShouldSkipRequiredValidationForMissingColumn(b,{object:a})){var d=e[b].required;("boolean"==typeof d?d:d(a))&&i.push(c({column:b,value:h,error:"required"}))}}return a}function $e(e,t,r){if(null===e)return{value:null};var n;if(n=t.parse?Be(e,t.parse):t.type?function(e,t,r){switch(t){case String:return Be(e,Ie);case Number:return Be(e,ke);case Date:return Be(e,(function(e){return function(e,t){var r=t.properties;if(e instanceof Date){if(isNaN(e.valueOf()))throw new xe("out_of_bounds");return e}if("number"==typeof e){if(isNaN(e))throw new xe("invalid_number");if(!isFinite(e))throw new xe("out_of_bounds");var n=J(e,r);if(isNaN(n.valueOf()))throw new xe("out_of_bounds");return n}throw new xe("not_a_date")}(e,{properties:r.properties})}));case Boolean:return Be(e,Ne);default:if("function"==typeof t)return Be(e,t);throw new Error("Unsupported schema type: ".concat(t&&t.name||t))}}(e,Array.isArray(t.type)?t.type[0]:t.type,r):{value:e},n.error)return n;if(null!==n.value){if(t.oneOf&&t.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(t.validate)try{t.validate(n.value)}catch(e){return{error:e.message}}}return n}function Be(e,t){try{var r=t(e);return void 0===r?{value:null}:{value:r}}catch(e){var n={error:e.message};return e.reason&&(n.reason=e.reason),n}}function ze(e,t,r){for(var n=0,o="";r+n<e.length;){var i=e[r+n];if(i===t)return[o,n];if('"'===i){var u=ze(e,'"',r+n+1);o+=u[0],n+=1+u[1]+1}else o+=i,n++}return[o,n]}var Xe=function(e){return e[0].map((function(t,r){return e.map((function(e){return e[r]}))}))};function Ge(e){return null==e}function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e){if("object"!==Ye(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==Ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ye(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Je(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.includeNullValues,o=r.ignoreEmptyRows,i=r.isColumnOriented,u=r.rowMap,a={schemaPropertyValueForMissingColumn:void 0,schemaPropertyValueForUndefinedCellValue:void 0,schemaPropertyValueForNullCellValue:void 0,schemaPropertyShouldSkipRequiredValidationForMissingColumn:function(e,t){return t.path,!1},getEmptyObjectValue:function(e,t){return t.path?void 0:null},getEmptyArrayValue:function(){return null},arrayValueSeparator:","};n&&(a.schemaPropertyValueForMissingColumn=null,a.schemaPropertyValueForUndefinedCellValue=null,a.schemaPropertyValueForNullCellValue=null,a.getEmptyObjectValue=function(e,t){return t.path,null});var l=function(e,t,r){var n=r=r?qe(qe({},Le),r):Le,o=n.isColumnOriented,i=n.rowIndexMap;!function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];if(!e[n].prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}(t),o&&(e=Xe(e));for(var u=e[0],a=[],l=[],c=1;c<e.length;c++){var f=Ue(t,e[c],c,void 0,u,l,r);a.push(f)}if(i)for(var s,p=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=_e(e))){t&&(e=t);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(l);!(s=p()).done;){var y=s.value;y.row=i[y.row-1]+1}return{rows:a,errors:l}}(e,t,He(He({},a),{},{rowIndexMap:u,isColumnOriented:i}));return!1!==o&&(l.rows=l.rows.filter((function(e){return e!==a.getEmptyObjectValue(e,{path:void 0})}))),l}function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}var Qe=["schemaPropertyValueForEmptyCell"];function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e){if("object"!==Ke(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==Ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ke(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function rt(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=e[o],u=void 0;"object"===tt(i)&&(i=Object.keys(e[o])[0],u=rt(e[o][i])),t[o]={prop:i},u&&(t[o].type=u)}return t}function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}var ot=["schema","map"];function it(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?it(Object(r),!0).forEach((function(t){var n,o,i;n=e,o=t,i=r[t],(o=function(e){var t=function(e){if("object"!==nt(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===nt(t)?t:String(t)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function at(e,t,r){var n=r.schema,o=r.map,i=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,ot);!n&&o&&(n=rt(o));var u=je(e,t,ut(ut({},i),{},{properties:n||i.properties}));return n?function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.schemaPropertyValueForEmptyCell;return e(t,r,et(et({},function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(n,Qe)),{},{schemaPropertyValueForNullCellValue:o}))}(Je,u.data,n,ut(ut({},i),{},{properties:u.properties})):u}function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yt(n.key),n)}}function st(e,t,r){return t&&ft(e.prototype,t),r&&ft(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pt(e,t,r){return(t=yt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yt(e){var t=function(e){if("object"!=lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lt(t)?t:t+""}var wt=st((function e(t,r,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),pt(this,"isCurrentReciever",!1),pt(this,"itemTotalValue",0),pt(this,"itemNewValue",0),pt(this,"itemNotForEmptyValue",0),pt(this,"itemToShipValue",0),pt(this,"currentShipValue",0),pt(this,"priority",void 0),pt(this,"createShopListRowElement",(function(e,t){var r=this,n=e.cloneNode(!0);n.querySelector(".table-data-shop-name").textContent=this.name,n.querySelector(".table-data-item-value").textContent=this.itemTotalValue;var o=n.querySelector(".input-shipping-value");return o.addEventListener("change",(function(e){r.changeCurrentShipValue(+o.value,t)})),n})),pt(this,"createResultRowElement",(function(e,t,r){var n=e.cloneNode(!0);return n.querySelector(".table-data-shop-shipper-name").textContent=this.name,n.querySelector(".table-data-shop-shipper-id").textContent=this.id,n.querySelector(".table-data-shop-reciever-id").textContent=t,n.querySelector(".table-data-shop-item-id").textContent=r,n.querySelector(".table-data-shop-shipping-value").textContent=this.currentShipValue,n})),pt(this,"changeCurrentShipValue",(function(e,t){this.currentShipValue=this.isCurrentReciever?0:e<=this.itemTotalValue?e:this.itemTotalValue,this.changeCurrentShipInputValue(),t&&t()})),pt(this,"changeCurrentShipInputValue",(function(){var e,t,r=this,n=null===(e=(t=document.querySelectorAll(".table-data-shop-name"),function(e){if(Array.isArray(e))return ct(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return ct(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ct(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).find((function(e){return e.textContent===r.name})))||void 0===e?void 0:e.closest(".table-row");n&&((null==n?void 0:n.querySelector(".input-shipping-value")).value=this.currentShipValue)})),pt(this,"createShopRecieverOption",(function(e){var t=e.cloneNode(!0);return t.querySelector(".option-shop-reciever").value=this.name,t.querySelector(".option-shop-reciever").textContent=this.name,t})),pt(this,"makeThisShopReciever",(function(e){this.isCurrentReciever=e})),pt(this,"fillTotalValue",(function(e){var t=this,r=e.find((function(e){return e[1]===t.name}));this.itemTotalValue=void 0===r?0:r[2]})),pt(this,"fillItemSpecificValues",(function(){this.itemTotalValue>0&&(this.itemNotForEmptyValue="Склад"===this.type?this.itemTotalValue-1:Math.floor(this.itemTotalValue/2),this.itemNewValue="Технопоинт"===this.type||"Склад"===this.type?this.itemTotalValue:this.itemTotalValue-1)})),pt(this,"calculatePriority",(function(e){var t=this.name in e&&"Склад"!==this.type?e[this.name]:"Склад"===this.type?0:1;this.priority=e[this.group]+e[this.warehouse]+t})),this.id=t,this.name=r,this.type=n,this.warehouse=o,this.group=i})),mt={"Пермь Склад":1e3,"Екатеринбург Склад":2e3,"Челябинск Склад":3e3,"Сургут ТП":4e3,Пермь:100,"Пермский край":200,Екб:100,"СВО 1":200,"СВО 2":300,"Север 1":400,"Север 2":500,Тюмень:600,"Тюменская обл":700,ЧБ:700,"ЧБО 1":800},vt=["Пермь ТК Чкаловский ТП","Пермь Космонавтов ТП","Пермь ТЦ Лайнер ТП","Пермь Склад","Екатеринбург Склад"],bt=[new wt("3 728","Пермь DNS Гайва","Розница","Пермь Склад","Пермь"),new wt("215","Пермь Айсберг","Розница","Пермь Склад","Пермь"),new wt("2 430","Пермь Космонавтов ТП","Технопоинт","Пермь Склад","Пермь"),new wt("3 842","Пермь на Веденеева","Розница","Пермь Склад","Пермь"),new wt("3 776","Пермь на Вышке 2","Розница","Пермь Склад","Пермь"),new wt("249","Пермь на Крупской","Розница","Пермь Склад","Пермь"),new wt("2 764","Пермь на Революции 5 А","Розница","Пермь Склад","Пермь"),new wt("4 088","Пермь На Стахановском Кольце","Розница","Пермь Склад","Пермь"),new wt("966","Пермь ТД Виктор","Розница","Пермь Склад","Пермь"),new wt("6 183","Пермь ТК Чкаловский ТП","Технопоинт","Пермь Склад","Пермь"),new wt("5 100","Пермь ТРК Планета","Розница","Пермь Склад","Пермь"),new wt("3 695","Пермь ТРК Семья","Розница","Пермь Склад","Пермь"),new wt("6 694","Пермь ТРК СпешиLove","Розница","Пермь Склад","Пермь"),new wt("6 092","Пермь ТРК Столица","Розница","Пермь Склад","Пермь"),new wt("517",'Пермь ТЦ "КИТ"',"Розница","Пермь Склад","Пермь"),new wt("5 195","Пермь ТЦ Времена года","Розница","Пермь Склад","Пермь"),new wt("4 160","Пермь ТЦ Горный Хрусталь","Розница","Пермь Склад","Пермь"),new wt("5 444","Пермь ТЦ Домино","Розница","Пермь Склад","Пермь"),new wt("3 181","Пермь ТЦ Земляника","Розница","Пермь Склад","Пермь"),new wt("7 342","Пермь ТЦ Искра","Розница","Пермь Склад","Пермь"),new wt("4 438","Пермь ТЦ Квартет","Розница","Пермь Склад","Пермь"),new wt("5 513","Пермь ТЦ Колизей Атриум","Розница","Пермь Склад","Пермь"),new wt("6 482","Пермь ТЦ Краснов","Розница","Пермь Склад","Пермь"),new wt("7 258","Пермь ТЦ Лайнер ТП","Технопоинт","Пермь Склад","Пермь"),new wt("1 358","Пермь ТЦ Шоколад","Розница","Пермь Склад","Пермь"),new wt("2 680","Пермь ЦУМ на 1905 года","Розница","Пермь Склад","Пермь"),new wt("5 863","Барда на Матросова","Розница","Пермь Склад","Пермский край"),new wt("3 034","Березники ТЦ Семья","Розница","Пермь Склад","Пермский край"),new wt("483","Березники ТЦ ЦУМ","Розница","Пермь Склад","Пермский край"),new wt("6 610","Березники Юбилейная площадь","Розница","Пермь Склад","Пермский край"),new wt("2 609","Верещагино ТЦ Лето","Розница","Пермь Склад","Пермский край"),new wt("4 417","Губаха Дегтярева","Розница","Пермь Склад","Пермский край"),new wt("6 082","Добрянка на Радищева","Розница","Пермь Склад","Пермский край"),new wt("4 477","Красновишерск на Дзержинского","Розница","Пермь Склад","Пермский край"),new wt("4 764","Краснокамск ТЦ Родина","Розница","Пермь Склад","Пермский край"),new wt("2 723","Кудымкар на Данилова","Розница","Пермь Склад","Пермский край"),new wt("5 000","Куеда на Гагарина","Розница","Пермь Склад","Пермский край"),new wt("3 192","Кунгур ТЦ Башня","Розница","Пермь Склад","Пермский край"),new wt("2 580","Кунгур ТЦ Гранат","Розница","Пермь Склад","Пермский край"),new wt("3 678","Лысьва ТЦ Сити Центр","Розница","Пермь Склад","Пермский край"),new wt("4 144","Нытва на Карла Маркса 64","Розница","Пермь Склад","Пермский край"),new wt("3 804","Оса на Максима Горького 79Б","Розница","Пермь Склад","Пермский край"),new wt("4 457","Очер на Урицкого","Розница","Пермь Склад","Пермский край"),new wt("5 616","Соликамск Бисмарк Авеню","Розница","Пермь Склад","Пермский край"),new wt("7 025","Соликамск ТЦ Экватор","Розница","Пермь Склад","Пермский край"),new wt("6 985","Суксун","Розница","Пермь Склад","Пермский край"),new wt("6 661","Чернушка Нефтяников 11А","Розница","Пермь Склад","Пермский край"),new wt("1 389","Чусовой ТЦ Сатурн","Розница","Пермь Склад","Пермский край"),new wt("1 527","ЕКБ Академический","Розница","Екатеринбург Склад","Екб"),new wt("5 234","ЕКБ Виктори молл","Розница","Екатеринбург Склад","Екб"),new wt("594","Екб Героев России ТП","Технопоинт","Екатеринбург Склад","Екб"),new wt("2 232","ЕКБ Гранат","Розница","Екатеринбург Склад","Екб"),new wt("3 506","ЕКБ ЖБИ ТЦ Кировский","Розница","Екатеринбург Склад","Екб"),new wt("2 191","ЕКБ Крауля","Розница","Екатеринбург Склад","Екб"),new wt("140","ЕКБ Ленина","Розница","Екатеринбург Склад","Екб"),new wt("2 791","ЕКБ Ленина-Гагарина","Розница","Екатеринбург Склад","Екб"),new wt("7 081","ЕКБ Метро Уралмаш","Розница","Екатеринбург Склад","Екб"),new wt("3 026","ЕКБ на Титова","Розница","Екатеринбург Склад","Екб"),new wt("7 300","ЕКБ Окей на Бабушкина","Розница","Екатеринбург Склад","Екб"),new wt("157","ЕКБ ПАРК ХАУС","Розница","Екатеринбург Склад","Екб"),new wt("4 888","ЕКБ Сахарова","Розница","Екатеринбург Склад","Екб"),new wt("3 435","ЕКБ Терминал Чкаловский","Розница","Екатеринбург Склад","Екб"),new wt("632","ЕКБ Техническая","Розница","Екатеринбург Склад","Екб"),new wt("806","ЕКБ ТРК Глобус","Розница","Екатеринбург Склад","Екб"),new wt("5 101","ЕКБ ТРЦ Веер Молл","Розница","Екатеринбург Склад","Екб"),new wt("1 102","ЕКБ ТРЦ Карнавал","Розница","Екатеринбург Склад","Екб"),new wt("4 910","ЕКБ ТРЦ Пассаж","Розница","Екатеринбург Склад","Екб"),new wt("5 503","ЕКБ ТРЦ Фан Фан Гипер","Розница","Екатеринбург Склад","Екб"),new wt("4 686","ЕКБ ТЦ Апельсин","Розница","Екатеринбург Склад","Екб"),new wt("5 262","ЕКБ ТЦ Белка Маркет Гипер","Розница","Екатеринбург Склад","Екб"),new wt("4 070","ЕКБ ТЦ Гринвич Гипер","Розница","Екатеринбург Склад","Екб"),new wt("7 083","ЕКБ ТЦ Гринвич Премиум","Розница","Екатеринбург Склад","Екб"),new wt("2 751","ЕКБ ТЦ Гудмарт","Розница","Екатеринбург Склад","Екб"),new wt("415","ЕКБ ТЦ Дирижабль","Розница","Екатеринбург Склад","Екб"),new wt("5 460","ЕКБ ТЦ Краснолесье","Розница","Екатеринбург Склад","Екб"),new wt("4 339","ЕКБ ТЦ МЕГА","Розница","Екатеринбург Склад","Екб"),new wt("124","ЕКБ ТЦ Мегаполис","Розница","Екатеринбург Склад","Екб"),new wt("1 536","ЕКБ ТЦ Омега","Розница","Екатеринбург Склад","Екб"),new wt("4 436","ЕКБ ТЦ Парус","Розница","Екатеринбург Склад","Екб"),new wt("1 696","ЕКБ ТЦ Радуга Парк","Розница","Екатеринбург Склад","Екб"),new wt("5 895","ЕКБ ТЦ Юла","Розница","Екатеринбург Склад","Екб"),new wt("5 816","ЕКБ Шарташский рынок","Розница","Екатеринбург Склад","Екб"),new wt("1 314","Верхняя Пышма на Ленина","Розница","Екатеринбург Склад","СВО 1"),new wt("4 029","Верхняя Пышма ТЦ Город VIP","Розница","Екатеринбург Склад","СВО 1"),new wt("6 976","Верхняя Пышма ТЦ Кировский","Розница","Екатеринбург Склад","СВО 1"),new wt("5 005","Верхняя Салда Клён","Розница","Екатеринбург Склад","СВО 1"),new wt("3 246","Карпинск на Мира","Розница","Екатеринбург Склад","СВО 1"),new wt("1 415","Качканар ТЦ Восток","Розница","Екатеринбург Склад","СВО 1"),new wt("4 337","Кировград ТЦ Радуга","Розница","Екатеринбург Склад","СВО 1"),new wt("2 846","Краснотурьинск на Попова","Розница","Екатеринбург Склад","СВО 1"),new wt("4 777","Красноуральск на Ленина","Розница","Екатеринбург Склад","СВО 1"),new wt("4 586","Кушва на Строителей","Розница","Екатеринбург Склад","СВО 1"),new wt("1 313","Лесной на Мира","Розница","Екатеринбург Склад","СВО 1"),new wt("7 232","Н.Тагил Гипер Лента","Розница","Екатеринбург Склад","СВО 1"),new wt("3 676","Н.Тагил КРЦ Россия","Розница","Екатеринбург Склад","СВО 1"),new wt("316","Н.Тагил Ленина","Розница","Екатеринбург Склад","СВО 1"),new wt("3 896","Н.Тагил на Газетной","Розница","Екатеринбург Склад","СВО 1"),new wt("5 903","Н.Тагил на Зари","Розница","Екатеринбург Склад","СВО 1"),new wt("4 388","Н.Тагил Семейный","Розница","Екатеринбург Склад","СВО 1"),new wt("5 624","Н.Тагил ТРЦ ДЕПО","Розница","Екатеринбург Склад","СВО 1"),new wt("6 200","Н.Тагил ТЦ Кардинал","Розница","Екатеринбург Склад","СВО 1"),new wt("7 148","Н.Тагил ТЦ Реал","Розница","Екатеринбург Склад","СВО 1"),new wt("2 035","Н.Тагил ТЦ Феникс","Розница","Екатеринбург Склад","СВО 1"),new wt("4 660","Невьянск на Матвеева","Розница","Екатеринбург Склад","СВО 1"),new wt("4 587","Нижняя Тура ТЦ 77","Розница","Екатеринбург Склад","СВО 1"),new wt("5 659","Новоуральск на Корнилова","Розница","Екатеринбург Склад","СВО 1"),new wt("2 930","Новоуральск ТЦ Комсомолец","Розница","Екатеринбург Склад","СВО 1"),new wt("3 607","Североуральск на Молодёжной","Розница","Екатеринбург Склад","СВО 1"),new wt("638","Серов в Центре","Розница","Екатеринбург Склад","СВО 1"),new wt("3 679","Серов ТЦ Небо","Розница","Екатеринбург Склад","СВО 1"),new wt("3 851","Среднеуральск ТЦ Исетский","Розница","Екатеринбург Склад","СВО 1"),new wt("1 425","Алапаевск на Ленина","Розница","Екатеринбург Склад","СВО 2"),new wt("4 334","Арамиль ТЦ Майский","Розница","Екатеринбург Склад","СВО 2"),new wt("3 834","Артемовский в Центре","Розница","Екатеринбург Склад","СВО 2"),new wt("4 335","Арти ТЦ Люкс","Розница","Екатеринбург Склад","СВО 2"),new wt("4 753","Асбест ТЦ Небо Гипер","Розница","Екатеринбург Склад","СВО 2"),new wt("5 237","Березовский ТЦ Центральный","Розница","Екатеринбург Склад","СВО 2"),new wt("2 315","Березовский ТЦ Яблоко","Розница","Екатеринбург Склад","СВО 2"),new wt("3 803","Богданович ТЦ Монетка","Розница","Екатеринбург Склад","СВО 2"),new wt("2 995","Заречный ТЦ Галактика","Розница","Екатеринбург Склад","СВО 2"),new wt("5 277","Каменск-Уральский ТЦ Дом","Розница","Екатеринбург Склад","СВО 2"),new wt("3 069","Каменск-Уральский ТЦ Магнит Экстра","Розница","Екатеринбург Склад","СВО 2"),new wt("4 065","Каменск-Уральский ТЦ Сити Молл","Розница","Екатеринбург Склад","СВО 2"),new wt("3 323","Камышлов ТЦ Флагман","Розница","Екатеринбург Склад","СВО 2"),new wt("5 008","Косулино ТЦ Пересвет","Розница","Екатеринбург Склад","СВО 2"),new wt("4 530","Красноуфимск на Советской","Розница","Екатеринбург Склад","СВО 2"),new wt("6 925","Михайловск на Кирова","Розница","Екатеринбург Склад","СВО 2"),new wt("6 838","Нижние Серги на Розы Люксембург","Розница","Екатеринбург Склад","СВО 2"),new wt("4 572","Первоуральск на Трубников","Розница","Екатеринбург Склад","СВО 2"),new wt("354","Первоуральск Пассаж","Розница","Екатеринбург Склад","СВО 2"),new wt("3 807","Первоуральск ТЦ Мегаполис","Розница","Екатеринбург Склад","СВО 2"),new wt("5 749","Первоуральск ТЦ Первый","Розница","Екатеринбург Склад","СВО 2"),new wt("3 731","Полевской ТЦ Палермо","Розница","Екатеринбург Склад","СВО 2"),new wt("5 596","Пышма на Кирова","Розница","Екатеринбург Склад","СВО 2"),new wt("4 336","Ревда ТЦ Квартал","Розница","Екатеринбург Склад","СВО 2"),new wt("3 532","Реж в Центре","Розница","Екатеринбург Склад","СВО 2"),new wt("4 427","Сухой Лог на Белинского","Розница","Екатеринбург Склад","СВО 2"),new wt("4 221","Сысерть ТЦ Бажов","Розница","Екатеринбург Склад","СВО 2"),new wt("4 847","Талица ТЦ Талица","Розница","Екатеринбург Склад","СВО 2"),new wt("4 750","Белый Яр ТЦ Станис","Розница","Екатеринбург Склад","Север 1"),new wt("3 159","Лангепас ТЦ Лангепас Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("1 651","Мегион ТЦ Юбилейный","Розница","Екатеринбург Склад","Север 1"),new wt("832","Нефтеюганск на Молодежной","Розница","Екатеринбург Склад","Север 1"),new wt("5 485","Нефтеюганск ТРЦ Оранжерея Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("2 997","Нефтеюганск ТЦ Оранж-Молл","Розница","Екатеринбург Склад","Север 1"),new wt("2 765","Нижневартовск ТД Ланкорд ТП","Технопоинт","Екатеринбург Склад","Север 1"),new wt("4 241","Нижневартовск ТК Север Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("4 431","Нижневартовск ТРЦ Грин Парк Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("2 029","Нижневартовск ТРЦ Европа-Сити","Розница","Екатеринбург Склад","Север 1"),new wt("3 390","Нижневартовск ТРЦ Югра Молл Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("6 982","Нижневартовск ТЦ Подсолнух Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("5 744","Нижневартовск ТЦ Флагман Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("4 676","Пойковский Торговый Центр","Розница","Екатеринбург Склад","Север 1"),new wt("3 916","Покачи ТД Югра","Розница","Екатеринбург Склад","Север 1"),new wt("2 990","Пыть-Ях ТЦ Европа","Розница","Екатеринбург Склад","Север 1"),new wt("5 081","Радужный ТЦ Подсолнух Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("1 414","Стрежевой ТГК Март","Розница","Екатеринбург Склад","Север 1"),new wt("6 214","Сургут на Ленина","Розница","Екатеринбург Склад","Север 1"),new wt("7 299","Сургут ТК Империя ТП","Технопоинт","Екатеринбург Склад","Север 1"),new wt("4 657","Сургут ТП","Склад","Екатеринбург Склад","Север 1"),new wt("3 075","Сургут ТРЦ Агора Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("3 369","Сургут ТРЦ Аура цифровой","Розница","Екатеринбург Склад","Север 1"),new wt("3 829","Сургут ТРЦ Вершина Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("5 447","Сургут ТРЦ Сити Молл","Розница","Екатеринбург Склад","Север 1"),new wt("6 720","Сургут ТРЦ Союз","Розница","Екатеринбург Склад","Север 1"),new wt("6 049","Сургут ТЦ FM","Розница","Екатеринбург Склад","Север 1"),new wt("4 338","Сургут ТЦ Авангард Гипер","Розница","Екатеринбург Склад","Север 1"),new wt("2 090","Сургут ТЦ Новый Мир ГИПЕР","Розница","Екатеринбург Склад","Север 1"),new wt("3 473","Белоярский ТРЦ Оазис Гипер","Розница","Екатеринбург Склад","Север 2"),new wt("2 345","Губкинский ТЦ Ямал-Пурпе ФТ","Розница","Екатеринбург Склад","Север 2"),new wt("2 746","Когалым СКК Галактика","Розница","Екатеринбург Склад","Север 2"),new wt("6 963","Когалым ТЦ Карнавал","Розница","Екатеринбург Склад","Север 2"),new wt("4 697","Лабытнанги ТЦ Рынок","Розница","Екатеринбург Склад","Север 2"),new wt("1 875","Лянтор ТЦ Лянтор Сити","Розница","Екатеринбург Склад","Север 2"),new wt("2 109","Муравленко ТЦ Тандем","Розница","Екатеринбург Склад","Север 2"),new wt("3 848","Надым DNS Гипер","Розница","Екатеринбург Склад","Север 2"),new wt("3 852","Новый Уренгой ТЦ Бумеранг","Розница","Екатеринбург Склад","Север 2"),new wt("2 032","Новый Уренгой ТЦ Вертолет","Розница","Екатеринбург Склад","Север 2"),new wt("3 354","Новый Уренгой ТЦ Проспект","Розница","Екатеринбург Склад","Север 2"),new wt("1 020","Ноябрьск на Ленина","Розница","Екатеринбург Склад","Север 2"),new wt("2 915","Ноябрьск ТЦ Городок","Розница","Екатеринбург Склад","Север 2"),new wt("6 864","Ноябрьск ТЦ Клубника","Розница","Екатеринбург Склад","Север 2"),new wt("988","Нягань ТРЦ Оазис","Розница","Екатеринбург Склад","Север 2"),new wt("7 297","Пангоды ТЦ Олимп","Розница","Екатеринбург Склад","Север 2"),new wt("3 664","Салехард Арктический Гипер","Розница","Екатеринбург Склад","Север 2"),new wt("3 864","Советский ТЦ Гранд","Розница","Екатеринбург Склад","Север 2"),new wt("7 361","Советский ТЦ Куб","Розница","Екатеринбург Склад","Север 2"),new wt("3 845","Тарко-Сале Дом Быта","Розница","Екатеринбург Склад","Север 2"),new wt("3 297","Урай ТЦ Перекресток Гипер","Розница","Екатеринбург Склад","Север 2"),new wt("3 108","Федоровский ТЦ Русская Забава","Розница","Екатеринбург Склад","Север 2"),new wt("5 720","Ханты-Мансийск Еврострой","Розница","Екатеринбург Склад","Север 2"),new wt("4 142","Ханты-Мансийск ТЦ Гермес","Розница","Екатеринбург Склад","Север 2"),new wt("3 554","Ханты-Мансийск ТЦ Меридиан Гипер","Розница","Екатеринбург Склад","Север 2"),new wt("2 312","Югорск ТЦ Лайнер Гипер","Розница","Екатеринбург Склад","Север 2"),new wt("6 600","Боровский на Островского","Розница","Екатеринбург Склад","Тюмень"),new wt("2 481","Ирбит на Площади Жукова","Розница","Екатеринбург Склад","Тюмень"),new wt("3 875","Тавда ТЦ Советский","Розница","Екатеринбург Склад","Тюмень"),new wt("1 681","Тобольск ТРЦ Жемчужина Сибири","Розница","Екатеринбург Склад","Тюмень"),new wt("520","Тобольск ТРЦ РИО","Розница","Екатеринбург Склад","Тюмень"),new wt("5 841","Тобольск ТЦ Лента","Розница","Екатеринбург Склад","Тюмень"),new wt("5 581","Туринск ТЦ ГлавныйПроспект","Розница","Екатеринбург Склад","Тюмень"),new wt("841","Тюмень Заречный","Розница","Екатеринбург Склад","Тюмень"),new wt("7 239","Тюмень Лента Тобольский тракт","Розница","Екатеринбург Склад","Тюмень"),new wt("3 214","Тюмень МФК Магеллан","Розница","Екатеринбург Склад","Тюмень"),new wt("1 811","Тюмень на Победы ТП","Технопоинт","Екатеринбург Склад","Тюмень"),new wt("358","Тюмень на Сибнефтепроводе","Розница","Екатеринбург Склад","Тюмень"),new wt("1 018","Тюмень на Червишевском","Розница","Екатеринбург Склад","Тюмень"),new wt("3 373","Тюмень Окей на Профсоюзной","Розница","Екатеринбург Склад","Тюмень"),new wt("5 984","Тюмень Преображенский","Розница","Екатеринбург Склад","Тюмень"),new wt("2 277","Тюмень ТРЦ Гудвин SMART","Розница","Екатеринбург Склад","Тюмень"),new wt("2 768","Тюмень ТРЦ Колумб","Розница","Екатеринбург Склад","Тюмень"),new wt("1 689","Тюмень ТРЦ Кристалл","Розница","Екатеринбург Склад","Тюмень"),new wt("3 885","Тюмень ТРЦ Матрешка","Розница","Екатеринбург Склад","Тюмень"),new wt("2 418","Тюмень ТРЦ Стар Сити Молл","Розница","Екатеринбург Склад","Тюмень"),new wt("7 260","Тюмень ТЦ Алебашевский Bazar","Розница","Екатеринбург Склад","Тюмень"),new wt("5 267","Тюмень ТЦ Арсиб Тауэр Гипер","Розница","Екатеринбург Склад","Тюмень"),new wt("6 584","Тюмень ТЦ Галактика","Розница","Екатеринбург Склад","Тюмень"),new wt("2 122","Тюмень ТЦ Остров","Розница","Екатеринбург Склад","Тюмень"),new wt("5 134","Тюмень ТЦ ХозДвор Гипер","Розница","Екатеринбург Склад","Тюмень"),new wt("1 880","Тюмень ТЦ ЦУМ SMART","Розница","Екатеринбург Склад","Тюмень"),new wt("3 111","Тюмень Ямская Гипер","Розница","Екатеринбург Склад","Тюмень"),new wt("6 061","Винзили ТЦ Магнит","Розница","Екатеринбург Склад","Тюменская обл"),new wt("5 201","Далматово ТЦ Магнит","Розница","Екатеринбург Склад","Тюменская обл"),new wt("3 359","Заводоуковск ТЦ Большой","Розница","Екатеринбург Склад","Тюменская обл"),new wt("3 805","Исетское ул. 50 Лет ВЛКСМ","Розница","Екатеринбург Склад","Тюменская обл"),new wt("331","Курган Гоголя","Розница","Челябинск Склад","Тюменская обл"),new wt("2 259","Курган Заозерный SMART","Розница","Челябинск Склад","Тюменская обл"),new wt("1 511","Курган Коли Мяготина","Розница","Челябинск Склад","Тюменская обл"),new wt("1 927","Курган Некрасова","Розница","Челябинск Склад","Тюменская обл"),new wt("3 377","Курган ТРЦ ГиперСити","Розница","Челябинск Склад","Тюменская обл"),new wt("425","Курган ТРЦ Пушкинский","Розница","Челябинск Склад","Тюменская обл"),new wt("4 315","Курган ТРЦ Стрекоза","Розница","Челябинск Склад","Тюменская обл"),new wt("1 932","Курган ТЦ Даниловский","Розница","Челябинск Склад","Тюменская обл"),new wt("4 714","Курган ТЦ Эллегия","Розница","Челябинск Склад","Тюменская обл"),new wt("5 202","Куртамыш на Ленина","Розница","Челябинск Склад","Тюменская обл"),new wt("1 354","Шадринск на Комсомольской","Розница","Екатеринбург Склад","Тюменская обл"),new wt("4 537","Шумиха ТД Привокзальный","Розница","Челябинск Склад","Тюменская обл"),new wt("4 228","Ялуторовск ТЦ Гулливер стр1","Розница","Екатеринбург Склад","Тюменская обл"),new wt("4 845","ЧБ Алмаз Гипер","Розница","Челябинск Склад","ЧБ"),new wt("3 682","ЧБ ДК Восток","Розница","Челябинск Склад","ЧБ"),new wt("175","ЧБ Ленина","Розница","Челябинск Склад","ЧБ"),new wt("244","ЧБ Молодогвардейцев","Розница","Челябинск Склад","ЧБ"),new wt("940","ЧБ МОПРа ТП","Технопоинт","Челябинск Склад","ЧБ"),new wt("5 711","ЧБ на Блюхера Гипер","Розница","Челябинск Склад","ЧБ"),new wt("4 875","ЧБ на Гагарина","Розница","Челябинск Склад","ЧБ"),new wt("5 546","ЧБ на Гагарина 35","Розница","Челябинск Склад","ЧБ"),new wt("1 333","ЧБ на Дзержинского","Розница","Челябинск Склад","ЧБ"),new wt("4 535","ЧБ на Мамина","Розница","Челябинск Склад","ЧБ"),new wt("442","ЧБ на Салютной","Розница","Челябинск Склад","ЧБ"),new wt("3 186","ЧБ на Степана Разина","Розница","Челябинск Склад","ЧБ"),new wt("4 309","ЧБ на Чичерина","Розница","Челябинск Склад","ЧБ"),new wt("4 169","ЧБ Парковый","Розница","Челябинск Склад","ЧБ"),new wt("235","ЧБ Сталеваров","Розница","Челябинск Склад","ЧБ"),new wt("942","ЧБ Теорема","Розница","Челябинск Склад","ЧБ"),new wt("213","ЧБ Теплотех","Розница","Челябинск Склад","ЧБ"),new wt("3 263","ЧБ ТК КС","Розница","Челябинск Склад","ЧБ"),new wt("3 348","ЧБ Точка выдачи доставок","Розница","Челябинск Склад","ЧБ"),new wt("2 862","ЧБ ТРК Горки","Розница","Челябинск Склад","ЧБ"),new wt("1 715","ЧБ ТРК Куба","Розница","Челябинск Склад","ЧБ"),new wt("1 621","ЧБ ТРК Фокус","Розница","Челябинск Склад","ЧБ"),new wt("7 164","ЧБ ТЦ АлоеПоле","Розница","Челябинск Склад","ЧБ"),new wt("4 373","ЧБ ТЦ Башня","Розница","Челябинск Склад","ЧБ"),new wt("529","ЧБ ТЦ Кольцо","Розница","Челябинск Склад","ЧБ"),new wt("4 947","ЧБ ТЦ Магнолия","Розница","Челябинск Склад","ЧБ"),new wt("4 305","ЧБ ТЦ Манхэттен","Розница","Челябинск Склад","ЧБ"),new wt("6 142","ЧБ ТЦ Фиеста","Розница","Челябинск Склад","ЧБ"),new wt("4 614","Аргаяш ТЦ Универмаг","Розница","Челябинск Склад","ЧБО 1"),new wt("2 467","Аша ТЦ Восход Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("4 321","Большеустьикинское ТЦ Вега","Розница","Челябинск Склад","ЧБО 1"),new wt("3 660","Верхний Уфалей ТЦ","Розница","Челябинск Склад","ЧБО 1"),new wt("5 491","Златоуст Машзавод","Розница","Челябинск Склад","ЧБО 1"),new wt("404","Златоуст Таганайская Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("3 522","Златоуст ТРК Агат Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("3 081","Златоуст ТРК Тарелка","Розница","Челябинск Склад","ЧБО 1"),new wt("3 745","Карабаш ТЦ МЕДь","Розница","Челябинск Склад","ЧБО 1"),new wt("2 918","Касли ТЦ Перекресток","Розница","Челябинск Склад","ЧБО 1"),new wt("4 536","Катав-Ивановск Торговый Центр","Розница","Челябинск Склад","ЧБО 1"),new wt("3 744","Куса в Центре","Розница","Челябинск Склад","ЧБО 1"),new wt("6 029","Кыштым ТК Гранд","Розница","Челябинск Склад","ЧБО 1"),new wt("3 677","Месягутово ТЦ Вега","Розница","Челябинск Склад","ЧБО 1"),new wt("7 252","Миасс на Макеева","Розница","Челябинск Склад","ЧБО 1"),new wt("1 039","Миасс ТЦ Карусель","Розница","Челябинск Склад","ЧБО 1"),new wt("2 732","Миасс ТЦ Семья Парк Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("1 568","Миасс ТЦ Слон Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("6 019","Миасское на Кирова","Розница","Челябинск Склад","ЧБО 1"),new wt("3 877","Нязепетровск ТД","Розница","Челябинск Склад","ЧБО 1"),new wt("5 775","Озерск Дом Обуви","Розница","Челябинск Склад","ЧБО 1"),new wt("3 659","Озерск ТК Родной","Розница","Челябинск Склад","ЧБО 1"),new wt("2 822","Озерск ТЦ Фестиваль","Розница","Челябинск Склад","ЧБО 1"),new wt("1 656","Сатка ТК Волна","Розница","Челябинск Склад","ЧБО 1"),new wt("4 294","Снежинск ТК Клондайк","Розница","Челябинск Склад","ЧБО 1"),new wt("2 786","Снежинск ТЦ Меркурий","Розница","Челябинск Склад","ЧБО 1"),new wt("1 449","Снежинск ТЦ Универмаг","Розница","Челябинск Склад","ЧБО 1"),new wt("2 469","Трехгорный ТЦ Апельсин","Розница","Челябинск Склад","ЧБО 1"),new wt("7 319","Усть-Катав 3-МКР","Розница","Челябинск Склад","ЧБО 1"),new wt("2 780","Усть-Катав ТК Семейный","Розница","Челябинск Склад","ЧБО 1"),new wt("2 868","Чебаркуль на Мира","Розница","Челябинск Склад","ЧБО 1"),new wt("4 904","Юрюзань на Советской","Розница","Челябинск Склад","ЧБО 1"),new wt("4 757","Аскарово на Тангатарской","Розница","Челябинск Склад","ЧБО 1"),new wt("6 293","Баймак на Юбилейной","Розница","Челябинск Склад","ЧБО 1"),new wt("1 066","Белорецк ТЦ 8 Марта Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("4 433","Белорецк ТЦ Аструм","Розница","Челябинск Склад","ЧБО 1"),new wt("4 758","Бреды на Ленина","Розница","Челябинск Склад","ЧБО 1"),new wt("5 424","Варна ТК Лотос","Розница","Челябинск Склад","ЧБО 1"),new wt("5 815","Верхнеуральск на Карла Маркса","Розница","Челябинск Склад","ЧБО 1"),new wt("4 102","Еманжелинск ТК Лето","Розница","Челябинск Склад","ЧБО 1"),new wt("2 762","Карталы ТЦ Фрегат","Розница","Челябинск Склад","ЧБО 1"),new wt("4 064","Копейск пр. Победы","Розница","Челябинск Склад","ЧБО 1"),new wt("2 793","Копейск ТК Урал","Розница","Челябинск Склад","ЧБО 1"),new wt("1 948","Копейск ТРК Слава","Розница","Челябинск Склад","ЧБО 1"),new wt("4 197","Коркино ТЦ Аллея","Розница","Челябинск Склад","ЧБО 1"),new wt("469","Магнитогорск на Карла Маркса","Розница","Челябинск Склад","ЧБО 1"),new wt("2 010","Магнитогорск ТП","Технопоинт","Челябинск Склад","ЧБО 1"),new wt("2 477","Магнитогорск ТРК Гостиный Двор","Розница","Челябинск Склад","ЧБО 1"),new wt("3 080","Магнитогорск ТРК Джаз Молл Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("1 821","Магнитогорск ТРК Континент","Розница","Челябинск Склад","ЧБО 1"),new wt("6 383","Магнитогорск ТРК Семейный парк Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("3 817","Магнитогорск ТЦ Тетрис Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("1 058","Магнитогорск ТЦ Тройка","Розница","Челябинск Склад","ЧБО 1"),new wt("4 748","Магнитогорск Универмаг на Пушкина","Розница","Челябинск Склад","ЧБО 1"),new wt("1 227","Магнитогорск ЦУМ Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("3 314","Пласт ТСК Раздолье","Розница","Челябинск Склад","ЧБО 1"),new wt("4 526","Сибай ТК Аструм","Розница","Челябинск Склад","ЧБО 1"),new wt("1 259","Сибай ТЦ Адель","Розница","Челябинск Склад","ЧБО 1"),new wt("1 187","Троицк на Гагарина","Розница","Челябинск Склад","ЧБО 1"),new wt("1 551","Учалы ТЦ Евразия Гипер","Розница","Челябинск Склад","ЧБО 1"),new wt("1 253","Южноуральск на Мира","Розница","Челябинск Склад","ЧБО 1"),new wt("1 864","Пермь Склад","Склад","Пермь Склад","Пермь"),new wt("2 018","Екатеринбург Склад","Склад","Екатеринбург Склад","Екб"),new wt("3 023","Челябинск Склад","Склад","Челябинск Склад","ЧБ")];function ht(e){return function(e){if(Array.isArray(e))return dt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return dt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var gt=document.querySelector(".input-file-add"),St=document.querySelector("#shopListRowTemplate").content,Ot=document.querySelector(".table-shop-list"),jt=document.querySelector(".input-item-id"),Et=document.querySelector("#shopRecieverOptionTemplate").content,At=document.querySelector(".select-shop-reciever"),Pt=document.forms["form-auto"],Ct=Pt.elements["button-auto-submit"],Vt=Pt.elements["input-item-value"],Tt=Pt.elements["checkbox-item-new"],xt=Pt.elements["checkbox-item-not-warehouse"],kt=Pt.elements["checkbox-item-dont-to-make-empty"],It=document.querySelector(".table-result"),Nt=document.querySelector("#resultRowTemplate").content,Dt=document.querySelector(".table-cell-value.section-shipping-info__table-cell"),Rt=document.querySelector(".section-shipping-info__status"),_t=document.querySelector(".section-shipping-info__error"),Ft=document.querySelector(".section-result"),Mt=document.querySelector(".svg-check-icon"),qt=document.querySelector(".dialog-add-file"),Lt=["Пермь Склад","Екатеринбург Склад","Челябинск Склад","Сургут ТП"];function Ut(e){e.target.checked&&(e.target===Tt?kt.checked=!1:Tt.checked=!1)}function $t(e){return bt.find((function(t){return t.name===e}))}function Bt(e,t,r){e&&t&&r?(Ct.disabled=!1,Ct.classList.remove("disabled")):(Ct.disabled=!0,Ct.classList.add("disabled"))}function zt(){jt.value&&At.value&&(Xt(),bt.forEach((function(e){var t;e.currentShipValue>0&&It.append(e.createResultRowElement(Nt,null===(t=$t(At.value))||void 0===t?void 0:t.id,jt.value))})),Jt())}function Xt(){ht(It.children).forEach((function(e,t){t>0&&e.remove()}))}function Gt(){return bt.filter((function(e){return"Склад"===e.type})).reduce((function(e,t){return e+t.itemTotalValue}),0)}function Yt(e){return ht(document.querySelectorAll(".table-cell-name")).find((function(t){return t.innerText===e})).closest(".section-total-info__table-row").querySelector(".table-cell-value")}function Wt(){var e=bt.find((function(e){return e.name===At.value})),t=e?e.itemTotalValue:0,r=e?e.itemNewValue:0;Lt.forEach((function(e){Yt(e).textContent=$t(e).itemTotalValue})),Yt("Итого на филиалах").textContent=bt.reduce((function(e,t){return e+t.itemTotalValue}),0)-Gt()-t,Yt("Из них не на витринах").textContent=bt.reduce((function(e,t){return e+t.itemNewValue}),0)-Gt()-r}function Ht(){return bt.reduce((function(e,t){return e+t.currentShipValue}),0)}function Jt(){var e=Ht();if(Dt.textContent=e,Vt.value&&e>0){var t=e>=Vt.value;!function(e){var t=e?"Все товары будут отгружены":"Не все товары будут отгружены";Rt.textContent=t,e?Rt.classList.add("text-ok"):Rt.classList.remove("text-ok")}(t),function(e,t){var r=e?"":"Не хватает ".concat(Vt.value-t," штук.");_t.textContent=r}(t,e)}else Rt.textContent="",_t.textContent=""}Tt.addEventListener("change",Ut),kt.addEventListener("change",Ut),gt.addEventListener("change",(function(){(function(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(r=t,r instanceof File||r instanceof Blob?r.arrayBuffer().then(F):F(r)).then((function(t){return at(t,e,n)}))})(gt.files[0]).then((function(e){var t,r;e=e.filter((function(e){return"#ERROR_undefined"!==e[0]&&"#ERROR_undefined"!==e[1]&&"#ERROR_undefined"!==e[2]&&e[2]>0})),t=e,bt.forEach((function(e){e.fillTotalValue(t),e.fillItemSpecificValues()})),r=mt,bt.forEach((function(e){e.calculatePriority(r)})),bt.sort((function(e,t){return e.priority-t.priority})),bt.forEach((function(e){e.itemTotalValue>0&&Ot.append(e.createShopListRowElement(St,zt))})),qt.close(),function(e,t){bt.filter((function(t){return e.includes(t.name)})).forEach((function(e){At.append(e.createShopRecieverOption(t))}))}(vt,Et),Wt()}))})),At.addEventListener("change",(function(e){!function(e){var t=bt.find((function(e){return!0===e.isCurrentReciever}));t&&t.makeThisShopReciever(!1);var r=$t(e.target.value);r.makeThisShopReciever(!0),r.changeCurrentShipValue(0,zt)}(e)})),Vt.addEventListener("input",(function(e){Bt(Vt.value,At.value,jt.value)})),At.addEventListener("change",(function(e){Bt(Vt.value,At.value,jt.value),Wt()})),jt.addEventListener("input",(function(e){Bt(Vt.value,At.value,jt.value)})),jt.addEventListener("change",(function(e){zt(),jt.value||Xt()})),Ft.addEventListener("click",(function(){var e;e="",ht(document.querySelectorAll(".result-table-row")).forEach((function(t){var r=t.querySelector(".table-data-shop-shipper-id").textContent,n=t.querySelector(".table-data-shop-reciever-id").textContent,o=t.querySelector(".table-data-shop-item-id").textContent,i=t.querySelector(".table-data-shop-shipping-value").textContent;e+="".concat(r,"\t").concat(n,"\t").concat(o,"\t").concat(i,"\n")})),navigator.clipboard.writeText(e).then((function(){console.log(e)})).catch((function(){console.log("something went wrong")})),Mt.classList.remove("hidden"),setInterval((function(){Mt.classList.add("hidden")}),1e3)})),Pt.addEventListener("submit",(function(e){e.preventDefault(),bt.forEach((function(e){e.itemToShipValue=Tt.checked?e.itemNewValue:kt.checked?e.itemNotForEmptyValue:e.itemTotalValue,xt.checked&&"Склад"===e.type&&(e.itemToShipValue=0)})),function(){bt.forEach((function(e){e.changeCurrentShipValue(0,!1)}));for(var e=0;e<+Vt.value;e++){var t=bt.find((function(e){return e.currentShipValue<e.itemToShipValue&&!1===e.isCurrentReciever}));if(Ht()<+Vt.value&&t){var r=t.currentShipValue+1;t.changeCurrentShipValue(r,!1),r++}}}(),Jt(),zt()})),qt.showModal()})();
//# sourceMappingURL=main.js.map